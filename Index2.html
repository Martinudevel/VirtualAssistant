<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbox and Graph Example</title>
    <!-- Font Awesome CDN for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        body {
            background-color: gold;
            background-image: url('Raiffeisen-Bank-International-logo.png');
            background-repeat: no-repeat;
            background-position: center;
            background-size: 940px 530px;
            color: black;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            height: 100vh;
        }
        .left-container, .right-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .left-container {
            margin-top: 0px;
            margin-left: 0px;
        }
        .right-container {
            margin-top: 50px;
            margin-right: 20px;
        }
        .chatbox, .scanbox, .chartbox, .listbox {
            background-color: #333;
            color: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            margin-bottom: 20px;
        }
        .chatbox {
            position: fixed;
            height: 100%;
            width: 400px;
            overflow-y: auto;
            margin-left: 400px;
            padding: 10px;
        }
        .chat-bubble {
            background-color: gold;
            color: rgb(0, 0, 0);
            margin-left: 5px;
            border: 8px solid gold;
            border-radius: 5px;
            margin-top: 10px;
            max-width: 60%;
            word-wrap: break-word;
            word-break: break-word;
            padding: 5px 10px;
        }
        .messages {
            position: fixed;
            margin-top: 40px;
            padding: 10px;
            overflow-y: auto;
            max-height: 85vh;
        }
        .scanbox {
            width: 100px;
            padding: 10px;
            text-align: center;
        }
        .chartbox {
            width: 350px;
            height: 250px;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
        .listbox {
            width: 600px;
            padding: 20px;
        }
        .input-box {
            display: flex;
            margin-top: 10px;
        }
        .input-box input {
            flex-grow: 1;
            padding: 5px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        .input-box button, .scanbox button {
            padding: 5px 10px;
            border-radius: 5px;
            border: none;
            background-color: gold;
            color: black;
            margin-left: 5px;
        }
        .listbox table {
            width: 100%;
            border-collapse: collapse;
        }
        .listbox th, .listbox td {
            padding: 10px;
            border: 1px solid #ccc;
        }
        .listbox th {
            background-color: #444;
        }
        canvas {
            width: 100% !important;
            height: 100% !important;
        }
        .gender-button {
            padding: 5px 10px;
            border-radius: 5px;
            border: none;
            background-color: rgb(0, 0, 0);
            color: rgb(255, 255, 255);
            margin-bottom: 20px;
        }
        .listbox tr:nth-child(even) {
            background-color: #444;
        }
        .listbox tr:nth-child(odd) {
            background-color: #555;
        }
        .listbox tr:hover {
            background-color: #666;
        }
        .filter-container {
            margin: 10px 0;
            text-align: center;
        }
        .week-selector-container {
            margin: 10px 0;
            text-align: center;
        }
        .transaction-icon {
            margin-right: 10px; /* Space between icon and provider name */
        }
    </style>
</head>
<body>
    <div class="left-container">
        <div class="chatbox">
            <h2>Chatbox</h2>
            <div class="input-box">
                <input type="text" id="messageInput" placeholder="Message" />
                <button onclick="sendMessage()">Send</button>
                <div class="messages" id="messages"></div>
            </div>
        </div>
    </div>
    <div class="right-container">
        <button class="gender-button" onclick="changeBackgroundColor()">Gender</button>
        <div class="chartbox">
            <canvas id="chart"></canvas>
        </div>
        <div class="scanbox">
            <button>Scan/Upload</button>
        </div>

        <!-- Transaction Box -->
        <div class="listbox">
            <h2>Istoric Tranzactii</h2>

            <!-- Week Selector -->
            <div class="week-selector-container">
                <label for="weekFilter">Select Week:</label>
                <select id="weekFilter" onchange="filterWeek()">
                    <option value="week1">Week 1</option>
                    <option value="week2">Week 2</option>
                    <option value="week3">Week 3</option>
                    <option value="week4">Week 4</option>
                </select>
            </div>

            <table id="transactionsTable">
                <thead>
                    <tr>
                        <th>Week</th>
                        <th>Cost (RON)</th>
                        <th>Provider</th>
                        <th>Person</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Transactions will be generated here -->
                </tbody>
            </table>

            <!-- Weekly Expenses Summary -->
            <div class="summary">
                <h3>Weekly Expenses Summary</h3>
                <p><strong>Child's Total Expenses:</strong> <span id="childTotal">65.49</span> RON</p>
                <p><strong>Mother's Total Expenses:</strong> <span id="motherTotal">309.98</span> RON</p>
                <p><strong>Father's Total Expenses:</strong> <span id="fatherTotal">385.98</span> RON</p>
                <p><strong>Total Household Expenses:</strong> <span id="totalExpenses">761.45</span> RON</p>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Function to send a message to the chatbox
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const messages = document.getElementById('messages');
            const message = document.createElement('div');
            message.classList.add('chat-bubble');
            message.textContent = input.value;
            messages.appendChild(message);
            input.value = '';
        }

        // Random Expense Generation for the week
        function generateRandomExpenses() {
            const transactionsTable = document.getElementById('transactionsTable').getElementsByTagName('tbody')[0];
            const weeks = ['week1', 'week2', 'week3', 'week4'];  // Weekly breakdown
            const providers = ['UPC Romania (Internet)', 'Netflix (Streaming)', 'Carrefour (Groceries)', 'Disney+ (Streaming)', 'Telekom Romania (Internet)', 'HBO Max (Streaming)'];
            const persons = ['child', 'mother', 'father'];
            const icons = ['fa-wifi', 'fa-film', 'fa-shopping-cart'];
            
            // Initialize totals for each person
            let childTotal = 65.49;
            let motherTotal = 309.98;
            let fatherTotal = 385.98;

            for (let i = 0; i < 30; i++) {  // Generate 30 days of random expenses
                const weekIndex = Math.floor(i / 7);  // Assign each day to a week
                const randomWeek = weeks[weekIndex];
                const randomCost = (Math.random() * (200 - 10) + 10).toFixed(2);  // Random cost between 10 and 200
                const randomProviderIndex = Math.floor(Math.random() * providers.length);
                const randomProvider = providers[randomProviderIndex];
                const randomPerson = persons[Math.floor(Math.random() * persons.length)];
                const randomIcon = icons[randomProviderIndex];  // Match icon to provider

                // Add the expense to the corresponding person's total
                if (randomPerson === 'child') {
                    childTotal += parseFloat(randomCost);
                } else if (randomPerson === 'mother') {
                    motherTotal += parseFloat(randomCost);
                } else if (randomPerson === 'father') {
                    fatherTotal += parseFloat(randomCost);
                }

                // Create a new row and add it to the table
                const row = transactionsTable.insertRow();
                row.classList.add(randomWeek, randomPerson);
                row.innerHTML = `
                    <td>${randomWeek}</td>
                    <td>${randomCost}</td>
                    <td><i class="fas ${randomIcon} transaction-icon"></i>${randomProvider}</td>
                    <td>${randomPerson.charAt(0).toUpperCase() + randomPerson.slice(1)}</td>
                `;
            }

            // Update the summary with the new totals
            document.getElementById('childTotal').textContent = childTotal.toFixed(2);
            document.getElementById('motherTotal').textContent = motherTotal.toFixed(2);
            document.getElementById('fatherTotal').textContent = fatherTotal.toFixed(2);
            document.getElementById('totalExpenses').textContent = (childTotal + motherTotal + fatherTotal).toFixed(2);
        }

        // Function to filter transactions by week
        function filterWeek() {
            const filter = document.getElementById('weekFilter').value;
            const rows = document.querySelectorAll('#transactionsTable tbody tr');
            rows.forEach(row => {
                if (row.classList.contains(filter)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        // Call the function to generate random expenses when the page loads
        generateRandomExpenses();
    </script>
</body>
</html>
